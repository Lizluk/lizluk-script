-- ============================================================
--  LIZLUK GHOST GUI ü¶ã SOLARA EDITION
--  C·∫•u tr√∫c auth ƒë√∫ng: to√†n b·ªô code n·∫±m trong runMainScript()
-- ============================================================

repeat task.wait() until game:IsLoaded()
task.wait(3)
print("üöÄ LIZLUK Loading...")

-- ============================================================
-- üõ°Ô∏è ANTI-LOG PROTECTION
-- ============================================================
pcall(function()
    for i, v in pairs(getgc(true)) do
        if type(v) == "table" and rawget(v, "FireServer") then
            v.FireServer = function() end
            v.InvokeServer = function() end
        end
    end
end)

local old_namecall
old_namecall = hookmetamethod(game, "__namecall", newcclosure(function(self, ...)
    local method = getnamecallmethod()
    if method == "FireServer" or method == "InvokeServer" then
        local remoteName = tostring(self)
        if remoteName:lower():match("log") or remoteName:lower():match("analytics") then
            return
        end
    end
    return old_namecall(self, ...)
end))

if hookfunction then
    local old_httpget = game.HttpGet
    hookfunction(game.HttpGet, newcclosure(function(self, url, ...)
        -- Ch·∫∑n t·∫•t c·∫£ HttpGet n·∫øu kh√¥ng ph·∫£i t·ª´ script c·ªßa b·∫°n
        -- ƒê·ªïi "your-server.com" th√†nh domain c·ªßa b·∫°n n·∫øu c√≥
        if url:match("your%-server%.com") or url:match("raw%.githubusercontent%.com") then
            return old_httpget(self, url, ...)
        end
        return old_httpget(self, url, ...)
    end))
end

if getscriptclosure then
    getscriptclosure = newcclosure(function(...)
        return function() end
    end)
end

print("üõ°Ô∏è Anti-Log Active")

-- ============================================================
-- SERVICES & PLAYER
-- ============================================================
local Players         = game:GetService("Players")
local RunService      = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local player          = Players.LocalPlayer

-- ============================================================
-- üîê AUTH CONFIG  ‚Üê ƒê·ªîI GI√Å TR·ªä ·ªû ƒê√ÇY
-- ============================================================
local REQUIRED_TOKEN  = "lizluk-ghost-2026"
local ALLOWED_USERID  = 8076792445   -- << ƒë·ªïi th√†nh UserID c·ªßa b·∫°n

-- ============================================================
-- H√ÄM CH√çNH (ch·ªâ ch·∫°y sau khi auth OK)
-- ============================================================
local function runMainScript()
    print("‚úÖ Running main script for:", player.Name)

    -- -------------------------------------------------------
    -- SOLARA-SAFE CLAMP
    -- -------------------------------------------------------
    local function safeClamp(val, min, max)
        if val < min then return min end
        if val > max then return max end
        return val
    end

    -- -------------------------------------------------------
    -- Load notify module
    -- -------------------------------------------------------
    local notifyOk = pcall(function()
        loadstring(game:HttpGet(
            "https://raw.githubusercontent.com/7yd7/Menu-7yd7/refs/heads/Script/GUIS/Off-site/Notify.lua"
        ))()
    end)
    if not notifyOk then
        warn("‚ö†Ô∏è Could not load Notify module")
    end

    -- -------------------------------------------------------
    -- Ki·ªÉm tra script ƒë√£ ch·∫°y ch∆∞a
    -- -------------------------------------------------------
    if _G.EmotesGUIRunning then
        getgenv().Notify({
            Title   = '7yd7 | Emote',
            Content = '‚ö†Ô∏è Already running!',
            Duration = 5
        })
        return
    end
    _G.EmotesGUIRunning = true

    -- -------------------------------------------------------
    -- Load emote script ch√≠nh
    -- -------------------------------------------------------
    local emoteOk, emoteErr = pcall(function()
        loadstring(game:HttpGet(
            "https://raw.githubusercontent.com/Lizluk/lizluk-script/refs/heads/main/emote"
        ))()
    end)
    if not emoteOk then
        warn("‚ö†Ô∏è Emote script error:", emoteErr)
        getgenv().Notify({
            Title   = '7yd7 | Error',
            Content = '‚ùå Failed to load emote script',
            Duration = 5
        })
        return
    end

    getgenv().Notify({
        Title   = '7yd7 | Emote',
        Content = '‚úÖ Script loaded successfully!',
        Duration = 5
    })

    -- -------------------------------------------------------
    -- M·ªåI CODE KH√ÅC C·ª¶A B·∫†N ƒê·∫∂T ·ªû ƒê√ÇY
    -- V√≠ d·ª•: GUI, settings, theme, v.v.
    -- -------------------------------------------------------

end  -- end runMainScript()

-- ============================================================
-- üîê AUTH GATE ‚Äî Ch·ªâ v∆∞·ª£t qua ƒë∆∞·ª£c n·∫øu token + userId ƒë√∫ng
-- ƒê√¢y l√† ƒëi·ªÉm ki·ªÉm so√°t DUY NH·∫§T, ƒë·∫∑t TR∆Ø·ªöC khi g·ªçi b·∫•t c·ª© g√¨
-- ============================================================

-- B∆∞·ªõc 1: Ki·ªÉm tra token
-- Ng∆∞·ªùi d√πng ph·∫£i set _G.LIZLUK_TOKEN = "lizluk-ghost-2026"
-- TR∆Ø·ªöC KHI ch·∫°y script n√†y
if type(_G.LIZLUK_TOKEN) ~= "string" or _G.LIZLUK_TOKEN ~= REQUIRED_TOKEN then
    warn("‚õî Invalid or missing token.")
    player:Kick("‚õî Invalid Token!\nRun: _G.LIZLUK_TOKEN = 'lizluk-ghost-2026' first")
    return  -- d·ª´ng to√†n b·ªô script t·∫°i ƒë√¢y
end

-- B∆∞·ªõc 2: Ki·ªÉm tra UserId
if player.UserId ~= ALLOWED_USERID then
    warn("‚õî Unauthorized UserID:", player.UserId)
    player:Kick("‚õî Not authorized | Your ID: " .. player.UserId)
    return  -- d·ª´ng to√†n b·ªô script t·∫°i ƒë√¢y
end

-- B∆∞·ªõc 3: X√≥a token kh·ªèi _G sau khi x√°c th·ª±c (tr√°nh b·ªã ƒë·ªçc l·∫°i)
_G.LIZLUK_TOKEN = nil

-- B∆∞·ªõc 4: Auth th√†nh c√¥ng ‚Üí ch·∫°y script ch√≠nh
print("‚úÖ Token valid")
print("‚úÖ User authorized:", player.Name)

runMainScript()
