--// LIZLUK TELE-FARMER ğŸ¦‹ (PHÃM Z Äá»‚ BAY | PHÃM X Äá»‚ AUTO FARM)
repeat task.wait() until game:IsLoaded()

local player = game:GetService("Players").LocalPlayer
local UIS = game:GetService("UserInputService")
local resources = workspace:WaitForChild("Resources")

-- Loáº¡i quáº·ng Ä‘ang chá»n Ä‘á»ƒ bay tá»›i / farm
_G.SelectedOre = "Iron"
_G.AutoFarming = false

---------------- ğŸ¨ Táº O GUI (CORE GUI - KÃ‰O ÄÆ¯á»¢C) ----------------
local gui = Instance.new("ScreenGui")
gui.Name = "Lizluk_TelePort"
pcall(function() gui.Parent = game:GetService("CoreGui") end)

local main = Instance.new("Frame", gui)
main.Size = UDim2.fromOffset(200, 400)
main.Position = UDim2.new(0.05, 0, 0.3, 0)
main.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
main.Active = true
Instance.new("UICorner", main)

-- KÃ©o tháº£ báº£ng
local d, ds, sp; main.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then d=true ds=i.Position sp=main.Position end end)
UIS.InputChanged:Connect(function(i) if d and i.UserInputType == Enum.UserInputType.MouseMovement then local dl=i.Position-ds main.Position=UDim2.new(sp.X.Scale, sp.X.Offset+dl.X, sp.Y.Scale, sp.Y.Offset+dl.Y) end end)
UIS.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then d=false end end)

local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1, 0, 0, 40)
title.Text = "CHá»ŒN QUáº¶NG (Z/X)"
title.TextColor3 = Color3.new(1, 1, 1)
title.BackgroundColor3 = Color3.fromRGB(142, 68, 173)
Instance.new("UICorner", title)

-- NÃºt báº­t/táº¯t Auto Farm
local autoBtn = Instance.new("TextButton", main)
autoBtn.Size = UDim2.new(0.9, 0, 0, 40)
autoBtn.Position = UDim2.new(0.05, 0, 0, 45)
autoBtn.Text = "AUTO FARM: Táº®T"
autoBtn.TextColor3 = Color3.new(1, 1, 1)
autoBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)
Instance.new("UICorner", autoBtn)

autoBtn.MouseButton1Click:Connect(function()
    _G.AutoFarming = not _G.AutoFarming
    autoBtn.Text = _G.AutoFarming and "AUTO FARM: Báº¬T" or "AUTO FARM: Táº®T"
    autoBtn.BackgroundColor3 = _G.AutoFarming and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(231, 76, 60)
    print(_G.AutoFarming and "âœ… Báº¬T AUTO FARM" or "â›” Táº®T AUTO FARM")
end)

local scroll = Instance.new("ScrollingFrame", main)
scroll.Size = UDim2.new(0.9, 0, 0.72, 0)
scroll.Position = UDim2.new(0.05, 0, 0.25, 0)
scroll.CanvasSize = UDim2.new(0, 0, 0, 350)
scroll.BackgroundTransparency = 1
Instance.new("UIListLayout", scroll).Padding = UDim.new(0, 5)

local ores = {"Iron", "Clay", "Copper", "Rock", "Coal", "Tin", "Tree", "Sand"}

for _, name in ipairs(ores) do
    local btn = Instance.new("TextButton", scroll)
    btn.Size = UDim2.new(0.95, 0, 0, 35)
    btn.Text = name
    btn.BackgroundColor3 = (_G.SelectedOre == name) and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(45, 45, 50)
    btn.TextColor3 = Color3.new(1, 1, 1)
    Instance.new("UICorner", btn)

    btn.MouseButton1Click:Connect(function()
        _G.SelectedOre = name
        -- Cáº­p nháº­t mÃ u nÃºt
        for _, v in pairs(scroll:GetChildren()) do
            if v:IsA("TextButton") then 
                v.BackgroundColor3 = (v.Text == name) and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(45, 45, 50)
            end
        end
        print("ÄÃ£ chá»n má»¥c tiÃªu: " .. name)
    end)
end

---------------- ğŸ› ï¸ HÃ€M TÃŒM VÃ€ Dá»ŠCH CHUYá»‚N ----------------
local function teleportToOre(skipNearby)
    local char = player.Character
    local root = char and char:FindFirstChild("HumanoidRootPart")
    if not root then return end

    local nearest = nil
    local minDist = math.huge

    for _, v in pairs(resources:GetChildren()) do
        -- Kiá»ƒm tra tÃªn model hoáº·c part bÃªn trong
        if v.Name:find(_G.SelectedOre) or v:FindFirstChild(_G.SelectedOre) then
            local p = v:IsA("BasePart") and v or v:FindFirstChildOfClass("BasePart") or v:FindFirstChildWhichIsA("BasePart", true)
            if p then
                local d = (root.Position - p.Position).Magnitude
                -- Náº¿u skipNearby = true thÃ¬ bá» qua cá»¥c gáº§n (cho teleport thá»§ cÃ´ng)
                -- Náº¿u skipNearby = false thÃ¬ láº¥y cá»¥c gáº§n nháº¥t (cho auto farm)
                if skipNearby then
                    if d > 5 and d < minDist then
                        minDist = d
                        nearest = p
                    end
                else
                    if d < minDist then
                        minDist = d
                        nearest = p
                    end
                end
            end
        end
    end

    if nearest then
        root.CFrame = CFrame.new(nearest.Position + Vector3.new(0, 3, 2), nearest.Position)
        print("ğŸš€ ÄÃ£ bay tá»›i: " .. _G.SelectedOre)
        return nearest
    else
        print("âŒ KhÃ´ng tÃ¬m tháº¥y cá»¥c " .. _G.SelectedOre .. " nÃ o!")
        return nil
    end
end

---------------- â›ï¸ HÃ€M FARM Tá»° Äá»˜NG ----------------
local currentTarget = nil
local isFarming = false
local Camera = workspace.CurrentCamera
local mouse = player:GetMouse()
local VIM = game:GetService("VirtualInputManager")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")

local function clickOre(orePart)
    if not orePart then return false end
    
    -- TÃ¬m model cha cá»§a quáº·ng
    local oreModel = orePart.Parent
    
    -- PhÆ°Æ¡ng phÃ¡p 1: Thá»­ Táº¤T Cáº¢ ClickDetector trong model
    local foundClick = false
    for _, child in pairs(oreModel:GetDescendants()) do
        if child:IsA("ClickDetector") then
            pcall(function()
                fireclickdetector(child, 0) -- 0 = left click
            end)
            foundClick = true
        end
    end
    
    if foundClick then return true end
    
    -- PhÆ°Æ¡ng phÃ¡p 2: Thá»­ ProximityPrompt
    for _, child in pairs(oreModel:GetDescendants()) do
        if child:IsA("ProximityPrompt") then
            pcall(function()
                fireproximityprompt(child)
            end)
            return true
        end
    end
    
    -- PhÆ°Æ¡ng phÃ¡p 3: Simulate MouseButton1Down/Up event
    pcall(function()
        -- Táº¡o fake input event
        local inputObject = {
            UserInputType = Enum.UserInputType.MouseButton1,
            UserInputState = Enum.UserInputState.Begin
        }
        
        -- Fire sá»± kiá»‡n click
        for _, v in pairs(getconnections(UserInputService.InputBegan)) do
            v:Fire(inputObject)
        end
        
        task.wait(0.05)
        
        inputObject.UserInputState = Enum.UserInputState.End
        for _, v in pairs(getconnections(UserInputService.InputEnded)) do
            v:Fire(inputObject)
        end
    end)
    
    -- PhÆ°Æ¡ng phÃ¡p 4: Fire táº¥t cáº£ RemoteEvents cÃ³ liÃªn quan
    pcall(function()
        for _, v in pairs(ReplicatedStorage:GetDescendants()) do
            if v:IsA("RemoteEvent") then
                local name = v.Name:lower()
                if name:find("mine") or name:find("hit") or name:find("swing") or name:find("damage") or name:find("harvest") or name:find("collect") then
                    v:FireServer(orePart)
                    v:FireServer(oreModel)
                    v:FireServer()
                end
            end
        end
    end)
    
    -- PhÆ°Æ¡ng phÃ¡p 5: VIM click (backup)
    pcall(function()
        VIM:SendMouseButtonEvent(0, 0, 0, true, game, 1)
        task.wait(0.05)
        VIM:SendMouseButtonEvent(0, 0, 0, false, game, 1)
    end)
    
    return true
end

spawn(function()
    while task.wait(0.15) do -- Click vá»›i táº§n suáº¥t vá»«a pháº£i
        if _G.AutoFarming then
            local char = player.Character
            local root = char and char:FindFirstChild("HumanoidRootPart")
            local humanoid = char and char:FindFirstChild("Humanoid")
            
            if root and humanoid then
                -- Náº¿u chÆ°a cÃ³ target hoáº·c target Ä‘Ã£ bá»‹ phÃ¡ há»§y
                if not currentTarget or not currentTarget.Parent then
                    print("ğŸ” Äang tÃ¬m má»¥c tiÃªu má»›i...")
                    currentTarget = teleportToOre(false)
                    if currentTarget then
                        print("âœ… ÄÃ£ tÃ¬m tháº¥y: " .. currentTarget.Name)
                        print("ğŸ“ Vá»‹ trÃ­: " .. tostring(currentTarget.Position))
                    end
                    task.wait(0.5)
                end
                
                -- Náº¿u cÃ³ target, tiáº¿p tá»¥c farm
                if currentTarget and currentTarget.Parent then
                    local dist = (root.Position - currentTarget.Position).Magnitude
                    
                    -- CHá»ˆ teleport láº¡i náº¿u QUÃ XA
                    if dist > 20 then
                        print("âš ï¸ QuÃ¡ xa, Ä‘ang Ä‘iá»u chá»‰nh...")
                        root.CFrame = CFrame.new(currentTarget.Position + Vector3.new(0, 3, 2), currentTarget.Position)
                        task.wait(0.3)
                    end
                    
                    -- Xoay nhÃ¢n váº­t nhÃ¬n vÃ o quáº·ng
                    root.CFrame = CFrame.new(root.Position, Vector3.new(currentTarget.Position.X, root.Position.Y, currentTarget.Position.Z))
                    
                    -- Click Ä‘á»ƒ farm
                    print("ğŸ”¨ Äang farm...")
                    clickOre(currentTarget)
                else
                    currentTarget = nil
                end
            end
        else
            currentTarget = nil
            task.wait(1)
        end
    end
end)

-- Theo dÃµi khi quáº·ng bá»‹ phÃ¡ há»§y
workspace.ChildRemoved:Connect(function(child)
    if currentTarget and (child == currentTarget or child == currentTarget.Parent) then
        print("âœ… ÄÃ£ farm xong! TÃ¬m má»¥c tiÃªu má»›i...")
        currentTarget = nil
    end
end)

resources.ChildRemoved:Connect(function(child)
    if currentTarget and (child == currentTarget or child == currentTarget.Parent) then
        print("âœ… ÄÃ£ farm xong! TÃ¬m má»¥c tiÃªu má»›i...")
        currentTarget = nil
    end
end)

---------------- âŒ¨ï¸ ÄIá»€U KHIá»‚N PHÃM Táº®T ----------------
UIS.InputBegan:Connect(function(input, g)
    if not g then
        if input.KeyCode == Enum.KeyCode.Z then
            teleportToOre(true) -- true = bá» qua cá»¥c quÃ¡ gáº§n
        elseif input.KeyCode == Enum.KeyCode.X then
            _G.AutoFarming = not _G.AutoFarming
            autoBtn.Text = _G.AutoFarming and "AUTO FARM: Báº¬T" or "AUTO FARM: Táº®T"
            autoBtn.BackgroundColor3 = _G.AutoFarming and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(231, 76, 60)
            print(_G.AutoFarming and "âœ… Báº¬T AUTO FARM" or "â›” Táº®T AUTO FARM")
        elseif input.KeyCode == Enum.KeyCode.K then
            main.Visible = not main.Visible
        end
    end
end)

print("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
print("â•‘   LIZLUK AUTO FARM - ÄÃƒ Táº¢I XONG!   â•‘")
print("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
print("â•‘  Z = Teleport Ä‘áº¿n quáº·ng gáº§n nháº¥t     â•‘")
print("â•‘  X = Báº­t/Táº¯t Auto Farm                â•‘")
print("â•‘  K = áº¨n/Hiá»‡n GUI                      â•‘")
print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
